### **2.1** 给定图 P2.1(a)和(b)所示两个电路，试列写出其状态方程和输出方程。其中，
分别指定：
(a)状态变量组$x_1=u_{C},x_{2}=i;$输入变量$u=e(t);$输出变量 y$=i$ 
(b)状态变量组 $x_1=u_{C_1},x_2=u_{C_2};$输入变量 $u=e(t);$输出变量 $y=u_c$
![[image.png]]
a)电容方程
$$C \frac{du_C}{dt} = i \implies \dot{x}_1 = \frac{1}{C} x_2.$$
 基尔霍夫电压定律（沿回路一周）
$$e(t) = v_R + v_L + v_C = R i + L \frac{di}{dt} + u_C.$$
整理得
$$L \dot{x}_2 = e(t) - R x_2 - x_1 \implies \dot{x}_2 = -\frac{1}{L} x_1 - \frac{R}{L} x_2 + \frac{1}{L} u.$$
输出方程 $y = x_2.$
$$\begin{bmatrix}\dot{x}_1\\\\\dot{x}_2\end{bmatrix}=\begin{bmatrix}0&\frac{1}{C}\\-\frac{1}{L}&-\frac{R}{L}\end{bmatrix}\begin{bmatrix}x_1\\x_2\end{bmatrix}+\begin{bmatrix}0\\\frac{1}{L}\end{bmatrix}u,$$
$$y=\begin{bmatrix}0&1\end{bmatrix}\begin{bmatrix}x_1\\x_2\end{bmatrix}$$
b) 两电容电流相等
回路电流 $i$ 同时流过 $C_{1}$、$C_{2}$，
$$i = C_{1} \dot{x}_{1} = C_{2} \dot{x}_{2}.$$
基尔霍夫电压定律
$$
e(t) = v_{R} + u_{C1} + u_{C2} = R i + x_{1} + x_{2} \implies i = \frac{1}{R} (u - x_{1} - x_{2}).$$
状态方程
$$\begin{cases}
\dot{x}_{1} = \frac{i}{C_{1}^{'} } = \frac{1}{R C_{1}^{'} } (u - x_{1} - x_{2}), \\
\dot{x}_{2} = \frac{i}{C_{2}^{'} } = \frac{1}{R C_{2}^{'} } (u - x_{1} - x_{2}).
\end{cases}$$
输出方程
$$y = x_{1} + x_{2}.$$

### **2.5** 求出下列各输入输出描述的一个状态空间描述
(i) $\dddot{y} + 2\ddot{y} + 6\dot{y} + 3y = 5u$

(ii) $\dddot{y} + 8\ddot{y} + 5\dot{y} + 13y = 4\dot{u} + 7u$

(iii) $3\dddot{y} + 6\ddot{y} + 12\dot{y} + 9y = 6\dot{u} + 3u$   
(Ⅰ) 选择状态变量为：
$$x_{1} = y$$
$$
x_{2} = \dot{y}$$
$$x_{3} = \ddot{y}$$
对状态变量求导：
$$
\dot{x}_{1} = \dot{y} = x_{2}$$
$$\dot{x}_{2} = \ddot{y} = x_{3}$$
$$
\dot{x}_{3} = \dddot{y} = -2\ddot{y} - 6\dot{y} - 3y + 5u$$
用状态变量替换 $y$ 及其导数：
$$\dot{x}_{3} = -2x_{3} - 6x_{2} - 3x_{1} + 5u$$
将这些方程写成矩阵形式：
$$
\begin{bmatrix}
\dot{x}_{1} \\
\dot{x}_{2} \\
\dot{x}_{3}
\end{bmatrix} =
\begin{bmatrix}
0 & 1 & 0 \\
0 & 0 & 1 \\
-3 & -6 & -2
\end{bmatrix}
\begin{bmatrix}
x_{1} \\
x_{2} \\
x_{3}
\end{bmatrix} +
\begin{bmatrix}
0 \\
0 \\
5
\end{bmatrix}u
$$
输出方程为 $y = x_{1}$。以矩阵形式表示为：
$$
y = \begin{bmatrix}
1 & 0 & 0
\end{bmatrix}
\begin{bmatrix}
x_{1} \\
x_{2} \\
x_{3}
\end{bmatrix} +
\begin{bmatrix}
0
\end{bmatrix}u
$$
因此，该系统的状态空间描述为：
$$
\mathbf{A} = \begin{bmatrix}
0 & 1 & 0 \\
0 & 0 & 1 \\
-3 & -6 & -2
\end{bmatrix}, \quad \mathbf{B} = \begin{bmatrix}
0 \\
0 \\
5
\end{bmatrix}, \quad \mathbf{C} = \begin{bmatrix}
1 & 0 & 0
\end{bmatrix}, \quad \mathbf{D} = \begin{bmatrix}
0
\end{bmatrix}
$$


（2）由于输入端存在零点参数，引入一个中间变量z，系统的传递函数为：
$$G(z) = \frac{Y(z)}{U(z)} = \frac{4z + 7}{z^3 + 8z^2 + 5z + 13}$$

基于中间变量z来定义状态变量：
$$
x_1 = z$$
$$x_2 = \dot{z}$$
$$
x_3 = \ddot{z}$$
求导可得：
$$\dot{x}_1 = \dot{z} = x_2$$
$$
\dot{x}_2 = \ddot{z} = x_3$$
$$\dot{x}_3 = \dddot{z} = -8\ddot{z} - 5\dot{z} - 13z + u = -8x_3 - 5x_2 - 13x_1 + u$$
状态方程的矩阵形式为：
$$
\begin{bmatrix} \dot{x}_1 \\ \dot{x}_2 \\ \dot{x}_3 \end{bmatrix} = \begin{bmatrix} 0 & 1 & 0 \\ 0 & 0 & 1 \\ -13 & -5 & -8 \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \\ x_3 \end{bmatrix} + \begin{bmatrix} 0 \\ 0 \\ 1 \end{bmatrix} u$$
输出方程 $y=4{\dot{z}}+7z$ 可以用状态变量表示为：
$$y = 7x_1 + 4x_2$$
其矩阵形式为：
$$
y = \begin{bmatrix} 7 & 4 & 0 \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \\ x_3 \end{bmatrix} + 0u$$
该系统的状态空间描述为：
$$\mathbf{A} = \begin{bmatrix} 0 & 1 & 0 \\ 0 & 0 & 1 \\ -13 & -5 & -8 \end{bmatrix}, \quad \mathbf{B} = \begin{bmatrix} 0 \\ 0 \\ 1 \end{bmatrix}, \quad \mathbf{C} = \begin{bmatrix} 7 & 4 & 0 \end{bmatrix}, \quad \mathbf{D} = \begin{bmatrix} 0 \end{bmatrix}$$

(3)将方程两边都除以3，使$\dddot{y}$的系数为1：

$$\dddot{y}+2\ddot{y}+4\dot{y}+3y=2\dot{u}+u$$

传递函数为：

$$G(z)=\dfrac{Y(z)}{U(z)}=\dfrac{2z+1}{z^3+2z^2+4z+3}$$基于 z 定义状态变量:
$$\begin{aligned}
x_{1} &= z \\
x_{2} &= \dot{z} \\
x_{3} &= \ddot{z}
\end{aligned}$$
求导可得:
$$\begin{aligned}
\dot{x}_{1} &= \dot{z} = x_{2} \\
\dot{x}_{2} &= \ddot{z} = x_{3} \\
\dot{x}_{3} &= \dddot{z} = -2\dot{z} - 4\ddot{z} - 3z + u = -2x_{3} - 4x_{2} - 3x_{1} + u
\end{aligned}$$
状态方程的矩阵形式为:
$$\begin{bmatrix}
\dot{x}_{1} \\
\dot{x}_{2} \\
\dot{x}_{3}
\end{bmatrix}
=
\begin{bmatrix}
0 & 1 & 0 \\
0 & 0 & 1 \\
-3 & -4 & -2
\end{bmatrix}
\begin{bmatrix}
x_{1} \\
x_{2} \\
x_{3}
\end{bmatrix}
+
\begin{bmatrix}
0 \\
0 \\
1
\end{bmatrix}
u$$
输出方程 y = 2$\dot{z}$ + z 可以用状态变量表示为:
$$y = x_{1} + 2x_{2}$$
其矩阵形式为:
$$
y = \begin{bmatrix}
1 & 2 & 0
\end{bmatrix}
\begin{bmatrix}
x_{1} \\
x_{2} \\
x_{3}
\end{bmatrix}
+
\begin{bmatrix}
0 \\
0 \\
1
\end{bmatrix}
u
$$
该系统的状态空间描述为:
$$
\mathbf{A} = \begin{bmatrix}
0 & 1 & 0 \\
0 & 0 & 1 \\
-3 & -4 & -2
\end{bmatrix}, \quad
\mathbf{B} = \begin{bmatrix}
0 \\
0 \\
1
\end{bmatrix}, \quad
\mathbf{C} = \begin{bmatrix}
1 & 2 & 0
\end{bmatrix}, \quad
\mathbf{D} = \begin{bmatrix}
0 \\
0 \\
1
\end{bmatrix}
$$


